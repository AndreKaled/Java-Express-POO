<div th:fragment="chat">

    <style>
        #chatbox {
            width: 100%;
            height: 400px;
            border: 1px solid #aaa;
            padding: 10px;
            overflow-y: auto;
            margin-bottom: 10px;
            background: #f7f7f7;
            border-radius: 6px;
        }

        .msg-user {
            margin: 5px 0;
            font-weight: bold;
            color: #0055ff;
        }

        .msg-bot {
            margin: 5px 0;
            color: #222;
        }
    </style>

    <div id="chatbox"></div>

    <input id="mensagem" type="text" placeholder="Digite sua mensagem..."
           style="width: 80%; padding: 8px;" />
    <button onclick="enviarMensagem()" style="padding: 8px 12px;">
        Enviar
    </button>

    <script>
        const chatbox = document.getElementById("chatbox");

        async function enviarMensagem() {
            const msg = document.getElementById("mensagem").value;
            if (!msg) return;

            chatbox.innerHTML += `<div class="msg-user">VocÃª: ${msg}</div>`;

            const resp = await fetch("/api/chat", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ mensagem: msg })
            });

            const json = await resp.json();
            chatbox.innerHTML += `<div class="msg-bot">Bot: ${json.resposta}</div>`;
            chatbox.scrollTop = chatbox.scrollHeight;

            document.getElementById("mensagem").value = "";
        }
    </script>

</div>
